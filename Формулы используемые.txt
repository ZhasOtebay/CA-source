
### 1. Нормирование данных

Чтобы стандартизировать данные, используем формулу:

\[
Y_{ij} = \frac{X_{ij} - \mu_j}{\sigma_j}
\]

где:
- \(Y_{ij}\) — нормализованное значение,
- \(X_{ij}\) — исходное значение,
- \(\mu_j\) — среднее значение по колонке \(j\),
- \(\sigma_j\) — стандартное отклонение по колонке \(j\).

### 2. Корреляционная матрица

Корреляционная матрица \(R\) вычисляется как:

\[
R = \frac{1}{n-1} Y^T Y
\]

где \(Y\) — матрица нормализованных данных (размер \(n \times m\)), и \(n\) — количество наблюдений.

### 3. Собственные значения и собственные векторы

Собственные значения и собственные векторы корреляционной матрицы находят следующим образом:

\[
R \mathbf{v} = \lambda \mathbf{v}
\]

где:
- \(R\) — корреляционная матрица,
- \(\lambda\) — собственное значение,
- \(\mathbf{v}\) — собственный вектор.

### 4. Упорядочение собственных значений и векторов

Собственные значения сортируются по убыванию:

\[
\lambda_1 \geq \lambda_2 \geq \ldots \geq \lambda_m
\]

Соответствующие собственные векторы упорядочиваются в соответствии с собственными значениями.

### 5. Выбор числа компонентов

Выбираем количество компонентов \(q\) так, чтобы собственные значения были больше 1:

\[
q = \sum_{i=1}^m \mathbf{1}(\lambda_i > 1)
\]

где \(\mathbf{1}\) — индикаторная функция.

### 6. Матрица нагрузок

Матрица нагрузок \(A\) вычисляется как:

\[
A = V \cdot D^{1/2}
\]

где:
- \(V\) — матрица собственных векторов (размер \(m \times q\)),
- \(D\) — диагональная матрица собственных значений (размер \(q \times q\)).

### 7. Значения главных компонент

Значения главных компонент \(F\) вычисляются по формуле:

\[
F = Y A
\]

где \(Y\) — нормализованные данные, \(A\) — матрица нагрузок.

### 8. Восстановление данных

Восстановленные данные в исходных единицах \(X_{\text{restored}}\) вычисляются по формуле:

\[
X_{\text{restored}} = F A^T \cdot \sigma + \mu
\]

где:
- \(F\) — матрица значений главных компонент,
- \(A^T\) — транспонированная матрица нагрузок,
- \(\sigma\) — стандартные отклонения исходных данных,
- \(\mu\) — средние значения исходных данных.

### Заключение

Эти формулы отражают математическую основу методов, применяемых в анализе главных компонент. Если у вас есть дополнительные вопросы или вы хотите подробнее остановиться на каком-то из шагов, дайте знать!